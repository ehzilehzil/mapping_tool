<!DOCTYPE html><html lang="ko"> <head><meta charset="utf-8"><meta name="viewport" content="width=device-width"><!-- <script src="https://cdn.jsdelivr.net/npm/jspreadsheet-ce@4/dist/index.min.js" is:inline></script>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jspreadsheet-ce@4/dist/jspreadsheet.min.css" type="text/css" />
        <script src="https://cdn.jsdelivr.net/npm/jsuites/dist/jsuites.min.js" is:inline></script>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jsuites/dist/jsuites.min.css" type="text/css" /> --><script src="https://cdn.jsdelivr.net/npm/papaparse@5.5.3/papaparse.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/papaparse@5.5.3/player/player.min.css" type="text/css"><title>ë§¤í•‘ íˆ´</title><link rel="stylesheet" href="/mapping_tool/_astro/index.BmC5zW20.css"></head> <body>  <div class="fixed top-0 right-0 bottom-0 left-0 p-1 flex flex-col"> <div class="grow-0 shrink-0 basis-16 flex w-full items-center gap-x-2"> <button id="description_btn">ì‚¬ìš©ë²• ì„¤ëª…</button> <dialog id="description_modal"> <div class="my-4">ì„¤ëª…ì„œ</div> <ol class="my-4 list-decimal list-inside space-y-2 text-gray-800"> <li>ë§¤ì¹­ì„ í•´ì•¼í•  íƒ€ê²Ÿ CSV íŒŒì¼(ex. 88ì½”ë“œ)ì„ ë¡œë“œí•©ë‹ˆë‹¤.
</li><li>"ê²€ìƒ‰ í‚¤ì›Œë“œ"ì— í‚¤ì›Œë“œë¥¼ ì…ë ¥í•©ë‹ˆë‹¤. ë³µìˆ˜ ì…ë ¥ì´ ê°€ëŠ¥í•˜ë©° ê³µë°±ìœ¼ë¡œ í‚¤ì›Œë“œë“¤ì„ êµ¬ë¶„í•©ë‹ˆë‹¤.</li> <li>ì•„ë˜ì— í‚¤ì›Œë“œ ë§¤ì¹­ì´ ë˜ëŠ” ì´ë¦„ì„ ê°€ì§„ íƒ€ê²Ÿ ê²€ìƒ‰ ê²°ê³¼ê°€ ë‚˜ì˜¤ëŠ”ë° ë§¤ì¹­ëœ ìˆœì„œëŒ€ë¡œ ìµœëŒ€ 20ê°œë§Œ ë‚˜ì˜µë‹ˆë‹¤.</li> <li>ì •í™•íˆ ë§¤ì¹­ë˜ëŠ” ì½”ë“œë¥¼ ì°¾ì•˜ë‹¤ë©´, ë”ë¸”í´ë¦­ -&gt; ctrl+C í´ë¦­ í•˜ì—¬ ë³µì‚¬í•©ë‹ˆë‹¤.</li> </ol> <div class="my-4">ESC í‚¤ë¥¼ ëˆ„ë¥´ë©´ ì„¤ëª…ì„œë¥¼ ë‹«ìŠµë‹ˆë‹¤.</div> </dialog> <button id="target_btn">íƒ€ê²Ÿ CSV ë¡œë“œ</button> <input type="file" id="target" accept=".csv" class="hidden"> </div> <div class="grow-0 shrink-0 basis-16 "> <div>ğŸ“¢ <span id="msg">í‚¤ì›Œë“œë“¤ì„ ì…ë ¥í•˜ë©´, í‚¤ì›Œë“œë“¤ì„ ë‹´ê³  ìˆëŠ” íƒ€ê²Ÿ ì´ë¦„ì„ ìœ„ì—ì„œë¶€í„° 20ê°œ ë³´ì—¬ì£¼ëŠ” Tool ì…ë‹ˆë‹¤.</span></div> </div> <div class="grow-0 shrink-0 basis-16 flex gap-x-2"> <div class="text-nowrap">ê²€ìƒ‰ í‚¤ì›Œë“œ: </div> <input id="keyword_input" type="text"> </div> <div class="grow-1 shrink-0 basis-0 overflow-y-auto"> <table class="w-full table-fixed text-center border"> <colgroup> <col style="width: 25%;"> <col style="width: 50%;"> <col style="width: 25%;"> </colgroup> <thead> <tr> <th>ì½”ë“œ</th> <th>ì´ë¦„</th> <th>ì´ë¯¸ì§€</th> </tr> </thead> <tbody id="search_result"></tbody> </table> </div> </div>  </body></html> <script>
    function* lazy_filter(fn, iterable) {
        for (const item of iterable) {
            if (fn(item)) yield item;
        }
    }

    function* lazy_take(n, iterable) {
        let i = 0;
        for (const item of iterable) {
            if (i++ === n) break;
            yield item;
        }
    }

    const lazy = {};
    lazy.filter = lazy_filter;
    lazy.take = lazy_take;
</script> <script>
	let tarobj = [];
	let isTargetReady = false;
	const $description_btn = document.getElementById("description_btn");
	const $description_modal = document.getElementById("description_modal");
	const $target_btn = document.getElementById("target_btn");
	const $target = document.getElementById("target");
	const $msg = document.getElementById("msg");
	const $keyword_input = document.getElementById("keyword_input");
	const $search_result = document.getElementById("search_result");


	$description_btn.onclick = (e) => $description_modal.showModal();


	$target_btn.onclick = () => $target.click();
	$target.onchange = (e) => {
		tarobj = [];
		const file = e.target.files[0];

		if (!file) {
			$msg.innerHTML = `íƒ€ê²Ÿ CSV íŒŒì¼ì´ ì„ íƒë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤!`;
			return;
		};
		const totalSize = file.size;
		let loadedSize = 0;

		$msg.innerHTML = `íƒ€ê²Ÿ CSV ë¡œë”© ì§„í–‰ì¤‘... 0%`;

		// console.log(file);

		Papa.parse(file, {
			worker: true, // ì„±ëŠ¥ í–¥ìƒ
			header: true,
			newline: "\r\n",
			skipEmptyLines: true,
			step: function (results, parser) {
				// ê° ì¤„ ì²˜ë¦¬ í›„ ì§„í–‰ë¥  ê³„ì‚°
				loadedSize += results.meta.cursor; // ëˆ„ì ëœ ë°”ì´íŠ¸ ìˆ˜
				const percent = Math.min(Math.round((loadedSize / totalSize) * 100), 100);
				// document.getElementById('progressBar').value = percent;
				$msg.innerHTML = `íƒ€ê²Ÿ CSV ë¡œë”© ì§„í–‰ì¤‘... ${percent}%`;
				
				if (results.data?.code) tarobj.push(results.data);
			},
			complete: function (_) {
				$msg.innerHTML = `íƒ€ê²Ÿ CSV ë¡œë”© ì™„ë£Œ!! ì´ ${tarobj.length}ê°œ ì½”ë“œê°€ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤.`;
				// console.log(tarobj);
				$target_btn.innerHTML = "íƒ€ê²Ÿ CSV ë¡œë“œ ì™„ë£Œ";
				$target_btn.setAttribute("disabled", "true");
				isTargetReady = true;
			}
		});
	};

	$keyword_input.oninput = (e) => {
		if (!isTargetReady) {
			$msg.innerHTML = "íƒ€ê²Ÿ CSV íŒŒì¼ì„ ë¨¼ì € ë¡œë“œí•´ì•¼í•©ë‹ˆë‹¤.";
		}


		$search_result.innerHTML = ``;
		let result = "";

		let keywords = e.currentTarget.value.trim().replace(/\s+/g, " ").split(" ");
		if (!keywords.length || keywords[0] === "") return;
		
		if (keywords.length > 10) keywords = keywords.slice(0, 10);
        console.log(keywords);
		
		let f = lazy.take(20,
			lazy.filter((x) => {
				let t = x.name;
				return keywords.every((y) => t.indexOf(y) !== -1);
			}, tarobj)
		);

		for (let x of f) {
			let t = x.name;
			for (let y of keywords) {
				t = t.replace(new RegExp(y, 'g'), `<b>${y}</b>`);
			}
			result += `<tr><td>${x.code}</td><td>${t}</td><td><a href="${x.image}" target="_blank">${x.image ? "ì´ë¯¸ì§€" : ""}</a></td></li>`;
		}

		$search_result.innerHTML = result;
	};
</script>